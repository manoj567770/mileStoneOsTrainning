<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
	<link rel="stylesheet" href="css/task5.css" />
</head>
<body>
	<div id="table"></div>

	<script>
		const arr = [{"name":"Jack","age":28,"city":"London","tech":"Node JS"},
		 {"name":"Mary","age":32,"city":"Mumbai","tech":"React JS"},
		 {"name":"Bob","age":35,"city":"New York","tech":"Angular JS"},
		 {"name":"Steve","age":26,"city":"NewDelhi","tech":"Javascript JS"},
		 {"name":"Edwards","age":27,"city":"Los Angeles","tech":"Node JS"},
		 {"name":"Catherine","age":31,"city":"Montreal","tech":"React JS"},
		 {"name":"Williams","age":34,"city":"New York","tech":"Android"},
		 {"name":"John","age":25,"city":"Moscow","tech":"Java"},
		 {"name":"Anna","age":33,"city":"Moscow","tech":"Node JS"},
		 {"name":"Julia","age":29,"city":"New Jersey","tech":"Android"}];

		const option = ['Name Starts With','City Starts With','Tech Starts With','Name,City or Tech Start With','Present in name,city or tech'];

		 showTable(arr);

		 function showTable(arr2){
			const arr1 = arr2.map(function(ele){
			let str = '<tr>';
				str+='<td class="td1">'+ele.name+'</td>';
				str+='<td class="td1">'+ele.age+'</td>';
				str+='<td class="td1">'+ele.city+'</td>';
				str+='<td class="td1">'+ele.tech+'</td>';
				str+= '</tr>';
				return str;
			});

			let header = '<tr>';
				header+='<th class="th1">Name</th>';
				header+='<th class="th1">Age</th>';
				header+='<th class="th1">City</th>';
				header+='<th class="th1">Technology</th>';
				header+= makeDDFn('pid',option,'','Select the Appropriate Filter','check');
				header+= '<input type = "text" id = "t1" placeholder="Enter the filter String" onblur="check(this)"></br>';
				header+= '</tr>';

			let html = '<table class=\'table1\'>'+header+arr1.join('')+'</table1>';
			let element = document.getElementById('table');
			element.innerHTML = html;
		}

		function check(elem){
			let selVal = document.getElementById('pid').value;
			console.log(selVal);
			let txt = document.getElementById("t1").value;
			console.log(txt);
			let len = elem.length;
			let flag = false;
			const list1 = arr.filter(function(w1){
				if(selVal=='Present in name,city or tech'){
					let index = w1.name.indexOf(txt);
					let index1 = w1.city.indexOf(txt);
					let index2 = w1.tech.indexOf(txt);
					if(index>-1 || index1>-1 || index2>-1){
						return w1.name || w1.city || w1.tech;
					}
				}
				
				 else if(selVal=='Name Starts With'){
				return w1.name.startsWith(txt);
			}else if(selVal=='City Starts With'){
				return w1.city.startsWith(txt);
			}
			else if(selVal=='Name,City or Tech Start With'){
				return w1.city.startsWith(txt)||w1.tech.startsWith(txt)||w1.name.startsWith(txt);
			}
			else{
				return w1.tech.startsWith(txt);
			}

			});
			
			showTable(list1);
		}

		function makeDDFn(id,data,selectedVal,valOnTop,onChangeFn){
			let dataMap = data.map(function(opt){
				if(opt==selectedVal)
					return '<option selected>'+opt+'</option>';
				else
					return '<option>'+opt+'</option>';
			});
			let first = '<option value=\'\' disabled>'+valOnTop+'</option>';
			if(selectedVal=='')
				first = '<option value=\'\' selected disabled>'+valOnTop+'</option>';
			let ddHtml = '<select id=\''+id+'\'>';
			
			ddHtml += first+dataMap.join('')+'</select>';
			return ddHtml;
		}




	</script>

</body>
</html>